<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1440, initial-scale=0.3, minimum-scale=0.1, maximum-scale=2.0, user-scalable=yes">
    <title>Dashboard - Claude Usage Monitor</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <div class="user-bar">
                <div class="sync-indicator" id="syncIndicator" title="Estado de sincronizacion">
                    <span class="sync-icon">&#x2601;</span>
                    <span class="sync-text" id="syncText">Sincronizado</span>
                </div>
                <div class="user-info">
                    <span class="user-email" id="userEmail">Cargando...</span>
                    <button class="btn-logout" id="logoutBtn" title="Cerrar sesion">Salir</button>
                </div>
            </div>
            <h1>Dashboard Hist√≥rico</h1>
            <p class="subtitle">Visualiza el uso hist√≥rico de tus cuentas Claude</p>

            <div class="navigation">
                <a href="index.html" class="nav-link">
                    <span>‚Üê Monitor Principal</span>
                </a>
            </div>
        </header>

        <div class="dashboard-controls">
            <div class="control-group">
                <label for="timeRange">Rango de Tiempo:</label>
                <select id="timeRange" class="select-input">
                    <option value="7">√öltimos 7 d√≠as</option>
                    <option value="14">√öltimos 14 d√≠as</option>
                    <option value="30" selected>√öltimos 30 d√≠as</option>
                    <option value="all">Todo el historial</option>
                </select>
            </div>

            <div class="control-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="showX2Mode" class="checkbox-input">
                    <span>Mostrar con l√≠mite x2</span>
                </label>
            </div>

            <button class="btn btn-danger" id="clearHistoryBtn">Limpiar Historial</button>
        </div>

        <div class="stats-grid">
            <div class="stat-card-small">
                <h3>Total de Registros</h3>
                <p class="stat-large" id="totalRecords">0</p>
            </div>
            <div class="stat-card-small">
                <h3>Primer Registro</h3>
                <p class="stat-medium" id="firstRecord">-</p>
            </div>
            <div class="stat-card-small">
                <h3>√öltimo Registro</h3>
                <p class="stat-medium" id="lastRecord">-</p>
            </div>
            <div class="stat-card-small">
                <h3>Cuenta M√°s Usada</h3>
                <p class="stat-medium" id="mostUsedAccount">-</p>
            </div>
        </div>

        <div class="week-comparison" id="weekComparison">
            <h2>Comparaci√≥n Semanal</h2>
            <p class="comparison-subtitle">Semana actual vs semana anterior</p>

            <div class="comparison-grid">
                <div class="comparison-card">
                    <h3 id="account1Name">Cuenta 1</h3>
                    <div class="comparison-values">
                        <div class="week-value">
                            <span class="week-label">Semana Anterior</span>
                            <span class="week-number" id="prevWeek1">-</span>
                        </div>
                        <div class="week-arrow" id="arrow1">‚Üí</div>
                        <div class="week-value">
                            <span class="week-label">Semana Actual</span>
                            <span class="week-number current" id="currentWeek1">-</span>
                        </div>
                    </div>
                    <div class="comparison-diff" id="diff1">
                        <span class="diff-label">Diferencia:</span>
                        <span class="diff-value">-</span>
                    </div>
                </div>

                <div class="comparison-card">
                    <h3 id="account2Name">Cuenta 2</h3>
                    <div class="comparison-values">
                        <div class="week-value">
                            <span class="week-label">Semana Anterior</span>
                            <span class="week-number" id="prevWeek2">-</span>
                        </div>
                        <div class="week-arrow" id="arrow2">‚Üí</div>
                        <div class="week-value">
                            <span class="week-label">Semana Actual</span>
                            <span class="week-number current" id="currentWeek2">-</span>
                        </div>
                    </div>
                    <div class="comparison-diff" id="diff2">
                        <span class="diff-label">Diferencia:</span>
                        <span class="diff-value">-</span>
                    </div>
                </div>

                <div class="comparison-card">
                    <h3 id="account3Name">Cuenta 3</h3>
                    <div class="comparison-values">
                        <div class="week-value">
                            <span class="week-label">Semana Anterior</span>
                            <span class="week-number" id="prevWeek3">-</span>
                        </div>
                        <div class="week-arrow" id="arrow3">‚Üí</div>
                        <div class="week-value">
                            <span class="week-label">Semana Actual</span>
                            <span class="week-number current" id="currentWeek3">-</span>
                        </div>
                    </div>
                    <div class="comparison-diff" id="diff3">
                        <span class="diff-label">Diferencia:</span>
                        <span class="diff-value">-</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="charts-container">
            <div class="chart-card">
                <h2>Uso por Cuenta a lo Largo del Tiempo</h2>
                <div class="chart-wrapper">
                    <canvas id="usageChart"></canvas>
                </div>
            </div>

            <div class="chart-card">
                <h2>Promedio de Uso por Cuenta</h2>
                <div class="chart-wrapper">
                    <canvas id="averageChart"></canvas>
                </div>
            </div>

            <div class="chart-card">
                <h2>Distribuci√≥n de Uso Actual</h2>
                <div class="chart-wrapper">
                    <canvas id="distributionChart"></canvas>
                </div>
            </div>

            <div class="chart-card">
                <h2>Capacidad Restante</h2>
                <div class="chart-wrapper">
                    <canvas id="remainingChart"></canvas>
                </div>
            </div>
        </div>

        <div class="no-data-message" id="noDataMessage">
            <div class="no-data-icon">üìä</div>
            <h2>No hay datos hist√≥ricos disponibles</h2>
            <p>Comienza a usar el monitor principal para generar datos hist√≥ricos autom√°ticamente.</p>
            <a href="index.html" class="btn btn-primary">Ir al Monitor Principal</a>
        </div>
    </div>

    <script src="supabase.js"></script>
    <script src="auth.js"></script>
    <script src="dashboard.js"></script>
</body>
</html>
